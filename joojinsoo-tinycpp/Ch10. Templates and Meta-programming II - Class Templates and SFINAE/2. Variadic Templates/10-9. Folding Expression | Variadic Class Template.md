# Folding Expressions

## 정의
- C++17에서는 템플릿 매개변수 팩을 임의의 이항 연산자(+, *, , , +=, &&, <= 등)로 접는(폴딩) 기능을 제공.
- 이 표현식은 매개변수 팩을 펼쳐서 이항 연산자로 결합하는 방식으로 작동.

## 종류
- 단항 접기(Unary Folding)
    - 매개변수 팩을 단일 연산자로 접어 처리한다.

```cpp
#include <iostream>

template<typename... Args>
auto add_unary(Args... args) {
    return (... + args); // 펼쳐짐: 1 + 2.0f + 3ll
}

int main() {
    std::cout << "Unary fold result: " << add_unary(1, 2.0f, 3ll) << std::endl; // 결과: 6.0f (float)
    return 0;
}
```

- 이항 접기(Binary Folding)
    - 시작값을 포함하여 매개변수 팩을 연산자로 접어서 처리한다.

```cpp
#include <iostream>

template<typename... Args>
auto add_binary(Args... args) {
    return (1 + ... + args); // 펼쳐짐: 1 + 1 + 2.0f + 3ll
}

int main() {
    std::cout << "Binary fold result: " << add_binary(1, 2.0f, 3ll) << std::endl; // 결과: 7.0f (float)
    return 0;
}
```


# Variadic Template and Classes

## 정의
- Variadic 템플릿은 가변 개수의 인자를 캡처하여 처리할 수 있는 템플릿.
- 여러 개의 값을 가지거나 타입을 가질 수 있는 매개변수 팩을 캡처한다.

```cpp
template<int... NArgs>
struct Add; // 데이터 구조 선언

template<int N1, int N2>
struct Add<N1, N2> { // 기본 케이스
    static constexpr int value = N1 + N2;
};

template<int N1, int... NArgs>
struct Add<N1, NArgs...> { // 재귀 케이스
    static constexpr int value = N1 + Add<NArgs...>::value;
};

// 사용 예시
int main() {
    constexpr int result = Add<2, 3, 4>::value; // 결과는 9
    std::cout << "Add<2, 3, 4>::value = " << result << std::endl;
    // Add<>; // 컴파일 오류: 매칭되는 템플릿 없음
    // Add<2>::value; // 컴파일 오류: Add<N1, NArgs...> 호출 후 Add<> 호출
    return 0;
}
```

## 함수 arity 가져오기
- Variadic 템플릿을 사용하여 함수의 매개변수 개수를 컴파일 타임에 가져올 수 있다.

```cpp
template <typename T>
class GetArity; // 기본 템플릿

// 함수 포인터
template<typename R, typename... Args>
class GetArity<R(*)(Args...)> {
public:
    static constexpr int value = sizeof...(Args);
};

// 함수 참조
template<typename R, typename... Args>
class GetArity<R(&)(Args...)> {
public:
    static constexpr int value = sizeof...(Args);
};

// 함수 객체
template<typename R, typename... Args>
class GetArity<R(Args...)> {
public:
    static constexpr int value = sizeof...(Args);
};

// 사용 예시
void f(int, char, double) {}

int main() {
    std::cout << "GetArity<decltype(f)>::value = " << GetArity<decltype(f)>::value << std::endl;
    auto& g = f;
    std::cout << "GetArity<decltype(g)>::value = " << GetArity<decltype(g)>::value << std::endl;
    auto* h = f;
    std::cout << "GetArity<decltype(h)>::value = " << GetArity<decltype(h)>::value << std::endl;
    return 0;
}
```
