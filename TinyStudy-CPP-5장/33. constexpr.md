
### `constexpr` 키워드
---

* 표현식이 컴파일 타임에 평가될 수 있다는 의미로 `constexpr` 키워드를 사용한다.
* 해당 키워드로 메모리 사용이나 컴파일 시간 등의 퍼포먼스에 이득이 될 수 있다.
* `constexpr`는 `const`의 기능을 포함한다.
* `constexpr` 변수는 항상 컴파일 시간에 측정된다.
```cpp
const int v1 = 3; // 컴파일 타임에 평가됨
int a = 3;
const int v2 = a; // 런타임에 평가됨.

constexpr int c1 = v1; // 컴파일타임에 평가됨
// constexpr int c2 = v2; // 컴파일 에러
```


* `constexpr` 함수는 함수의 인수가 컴파일 시간에 표현 가능하다면, 함수도 컴파일 타임에 평가될 수 있다. 즉, 컴파일 타임에 함수의 리턴 값을 알 수 있다.
```cpp
constexpr int square(int vaule){
	return value * value;
}
square(4); // 컴파일 타임에 평가됨.
int x = 4;
square(x); // 런타임에 평가됨.
```


### `constexpr` 함수 주의사항
---

1. 런타임 함수들을 포함할 수 없음.
2. `try-catch`문, 예외 등과 같은 런타임에 사용되는 요소들과 함께 쓸 수 없음.
3. `goto`와 `asm`을 포함할 수 없음.
4. `static` 변수를 포함할 수 없음.
5. C++11까지, 오로지 하나의 `return` 만을 사용해야 함.
6. C++14까지, `assert()` 함수를 포함할 수 없음.
7. C++20까지, 가상 함수가 아니어야 함.
8. undefined behavior 는 불가.

* 런타임 객체의 non-static 인 `constexpr` 맴버 함수는 사용할 수가 없다.
* `static constexpr` 맴버 함수는 특정 객체에 의존하지 않기 때문에 사용 가능하다.

```cpp
struct A { 
	constexpr int f() const { return 3; } 
	static constexpr int g() { return 4; } 
}; 
A a1; 
// constexpr int x = a1.f(); // 컴파일 에러 
constexpr int y = a1.g();
A a2; 
constexpr int x = a2.f();
```

