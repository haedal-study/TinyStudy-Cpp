
### Operator Overloading
---

- 연산자 오버로딩(Operator Overloading)은 연산자를 클래스의 다형성 함수로 재정의한다. 해당 클래스의 객체끼리 연산을 할 때, 오버로딩한 연산자를 실행시킨다.
```cpp
struct Point {
	int x, y;
	Point operator+(const Point& p) const {
		return { x + p.x, y + p.y };
	}
};

Point a{ 1,2 };
Point b{ 2,3 };
Point c = a + b; // c.x = 3, c.y = 5
```

- 주로 오버로딩 하는 연산자
	- 산술 연산자 `+, -, /, *, %, ++, --`
	- 비교 연산자 `==, !=, <, <=, >, >=, <=>`
	- 복합 할당 연산자 `+=, -=, /=, *=, %=`
	- 아래첨자 `[]`
	- 함수 호출 연산자`()`

- 오버로딩 불가능한 연산자
	- `?, ., .*, ::, sizeof, typeof`


### Spaceship Operator `operator<=>`
---

- 우주선 연산자 오버로딩 하나로 다음의 연산자 오버로딩을 대체할 수 있다.
```cpp
struct A {
  int x;

  bool operator==(const A& o) const {
    return x == o.x;
  }
  bool operator!=(const A& o) const {
    return x != o.x;
  }
  bool operator<(const A& o) const {
    return x < o.x;
  }
  bool operator<=(const A& o) const {
    return x <= o.x;
  }
  bool operator>(const A& o) const {
    return x > o.x;
  }
  bool operator>=(const A& o) const {
    return x >= o.x;
  }
};
```

- 아래로 대체 가능
```cpp
struct A {
  int x;

  auto operator<=>(const A& o) const {
    return x <=> o.x;
  }
  bool operator==(const A& o) const {
    return x == o.x;
  }
};
```

- 우주선 연산자에는 `default` 연산자를 적용할 수 있어, 여러 필드값이나 배열들을 비교해주는 코드를 자동으로 삽입할 수 있다.
- `default`로 정의한 우주선 연산자는 `==`연산자도 포함한다.
```cpp
struct A {
	int x;
	int y;
	int z[2];
	auto operator<=>(const A&) const = default;
	// x == other.x이면 y를 비교
	// y == other.y이면 z를 비교
	// z[0] == other.z[0]이면 다음인덱스를 비교 ...
};

A a{ 10 , 9, {1,2} };
A b{ 10 , 9, {1,3} };
cout << (a < b); // true
cout << (a == b);// false
```

- 우주선 연산자를 사용한 객체들의 순서를 정하는 3가지 방법
	- 강한 순서(strong order)
		- a == b일 때, f(a) == f(b)를 만족한다.
		- `<, ==, >`중에 하나는 true이다.
		- ex. int, char 같은 정수형 값
	- weak order
		- a == b일 때, f(a) == f(b)가 아닐 수도 있다.
		- `<, ==, >`중 하나는 true이다.
		- ex. 직사각형 : 직사각형이 같은지 비교할 경우, 가로x세로 1x5 직사각형과 5x1 직사각형은 크기는 같지만 형태는 다르다.
	- partial order
		- a == b일 때, f(a) == f(b)가 아닐 수도 있다.
		- `<, ==, >` 중 전부 false일 수 있다.
		- 부동소수점형(float, double) : `NaN`은 `NaN`과  비교해도 같지 않다.



참고자료
[C++: Overloading the Spaceship Operator, A Recipe (indii.org)](https://indii.org/blog/overloading-the-spaceship-operator/)
