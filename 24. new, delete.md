
### new, delete
---

* `new`/`new[]` , `delete`/`delete[]`는 동적 메모리 할당/해제, 객체의 생성/삭제를 런타임에 수행하도록 하는 키워드다.

* `new`, `delete`의 장점
	* 함수가 아니라 키워드라 안전하다.
	* `malloc()`이 void* 를 리턴하는 것과 달리, `new`는 정확한 데이터 타입을 반환한다.
	* 할당 실패 시, `new`는 예외처리가 되지만, `malloc()`은 NULL 포인터만을 반환한다.
	* `new`를 사용하면 할당 크기를 컴파일러가 계산하지만, `malloc()`은 사용자가 직접 계산해야한다.
	* `new`키워드로 할당과 함께 초기화도 할 수 있다.
	* 가상함수가 있는 객체는 가상테이블포인터를 초기화하려면 반드시 new로 할당되어야 한다. 

```cpp
// 단일 할당
int* val = new int;
// N개 할당
int* arr = new int[N];
// N개 할당하고 0으로 초기화
int* arr = new int[N]();

// 단일 해제
delete var;
// N개 해제
delete[] arr;
```


### 할당/해제 기본 규칙
---

* `malloc()` <=> `free()`
* `new` <=> `delete`
* `new[]` <=> `delete[]`
* `malloc(), new, new[]`는 할당 성공 시 `NULL`을 반환하지 않는다. 0 크기 할당의 경우는 구현에 따라 다르다.
* `free(), delete, delete[]`는 `NULL, nullptr`에 대해 오류를 발생시키지 않는다.
* 위 할당 <=> 해제 짝을 맞추지 않고 혼용한다면 undefined behavior을 발생시킬 수 있다.


* 2D 메모리 할당
```cpp
auto A = new int[3][4]; 
int n = 3; // dynamic value 
auto B = new int[n][4]; // ok 
// auto C = new int[n][n]; // compile error 
delete[] A; // same for B, C
```

