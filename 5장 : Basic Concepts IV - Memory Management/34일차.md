# [consteval | constinit | if constexpr]

## consteval
C++20에서 도입된 기능으로, 즉시 함수라고도 불림   
이 함수는 반드시 컴파일 시간에 평가되어야 함을 보장함   
=> 비상수 값이 사용되는 경우 컴파일 오류가 발생함   

~~~cpp
consteval int square(int value){
    return value * value;
}

square(4); //컴파일 시간에 평가됨

int v = 4; //v는 동적인 값
square(v); //컴파일 오류
~~~
square 함수는 consteval로 선언   
-> 컴파일 시간에 인수가 상수 값이 되어야 함   
==> 상수 값이 아닌 변수 'v'를 사용하면 컴파일 오류가 발생함

## constinit
C++20에서 도입된 기능   
변수의 컴파일 시간 초기화를 보장함   
비상수 값이 사용되는 경우 컴파일 오류가 발생함

~~~cpp
constexpr int square (int value){
    return value * value;
}

constinit int v1 = square(4); //컴파일 시간 초기화
v1 = 3; //v1 값 변경 가능

int a = 4; //a는 동적인 값
constinit int v2 = square(a); //컴파일 오류
~~~
constinit으로 선언된 변수 v1은 컴파일 시간에 square(4)의 결과로 초기화됨   
v1은 값 변경이 가능함   
but 다른 비상수 값 a를 사용한 변수 초기화할 경우 컴파일 오류 발생

## if constexpr
C++17에서 도입된 기능   
컴파일 시간 값을 기준으로 조건부로 코드를 컴파일하는 데 사용됨   
컴파일 시간에 조건을 검사하고, 조건이 참이면 해당 브랜치를 컴파일하고 그렇지 않으면 해당 브랜치를 무시함

~~~cpp
auto f(){
    if constexpr (sizeof(void*) == 8)
        return "hello"; //const char*
    else
        return 3; //int, 절대로 컴파일되지 않음
}
~~~
sizeof(void*)의 값이 8일 때 "hello"를 반환   
그렇지 않은 경우 3 반환   
이때 else 브랜치는 컴파일되지 않음 (실행 시 이 코드는 실행되지 않음)
